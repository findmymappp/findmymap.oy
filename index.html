<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ì˜¬ë¦¬ë¸Œì˜ ê¸¸ì°¾ê¸°</title>
  <style>
    body {
      margin: 0;
      padding: 0;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen,
        Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
      background: #f5f5f5;
      display: flex;
      flex-direction: column;
      min-height: 100vh;
      position: relative;
    }
    #map {
      width: 100%;
      height: 450px;
      background: #eee;
      border-bottom: 1px solid #ccc;
      flex-shrink: 0;
    }
    #language {
      position: fixed;
      top: 12px;
      right: 12px;
      z-index: 1000;
      font-size: 14px;
      padding: 6px 10px;
      border-radius: 6px;
      border: 1px solid #ccc;
      background-color: white;
      box-shadow: 0 2px 6px rgba(0,0,0,0.15);
      width: 160px;
      appearance: none;
      -webkit-appearance: none;
      -moz-appearance: none;
      cursor: pointer;
    }
    .buttons {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      padding: 10px 12px 15px;
      margin-top: 10px;
    }
    button {
      flex: 1 1 45%;
      background-color: #4caf50;
      color: white;
      border: none;
      border-radius: 6px;
      padding: 12px 8px;
      font-size: 15px;
      cursor: pointer;
      transition: background-color 0.3s ease;
      min-width: 120px;
    }
    button:hover {
      background-color: #388e3c;
    }
    #refresh {
      background-color: #2196f3;
      flex: 1 1 100%;
    }
    #refresh:hover {
      background-color: #1565c0;
    }
    #info {
      padding: 0 12px 15px;
      font-size: 14px;
      color: #333;
      min-height: 32px;
      line-height: 1.3;
    }
  </style>

  <script src="https://dapi.kakao.com/v2/maps/sdk.js?appkey=7984bae577e26f048c7b8608f9008187&libraries=services,geometry"></script>
</head>
<body>
  <div id="map"></div>

  <select id="language" onchange="changeLanguage()">
    <option value="ko">ğŸ‡°ğŸ‡· í•œêµ­ì–´</option>
    <option value="en">ğŸ‡ºğŸ‡¸ English</option>
    <option value="zh">ğŸ‡¨ğŸ‡³ ä¸­æ–‡</option>
    <option value="ja">ğŸ‡¯ğŸ‡µ æ—¥æœ¬èª</option>
  </select>

  <div class="buttons" id="buttons">
    <button onclick="setDestination(0)" id="btn0">ì˜¬ë¦¬ë¸Œì˜ ë™ëŒ€ë¬¸ì—­ì‚¬ë¬¸í™”ê³µì›ì—­ì </button>
    <button onclick="setDestination(1)" id="btn1">ì˜¬ë¦¬ë¸Œì˜ ë˜ë˜ë™ëŒ€ë¬¸ì </button>
    <button onclick="setDestination(2)" id="btn2">ì˜¬ë¦¬ë¸Œì˜ ë‘íƒ€ì </button>
    <button onclick="setDestination(3)" id="btn3">ì˜¬ë¦¬ë¸Œì˜ í˜„ëŒ€ì‹œí‹°ì•„ìš¸ë ›ë™ëŒ€ë¬¸ì </button>
    <button onclick="refreshLocation()" id="refresh">í˜„ì¬ ìœ„ì¹˜ ê°±ì‹ </button>
  </div>

  <div id="info"></div>

  <script>
    const destinations = [
      { name: 'ì˜¬ë¦¬ë¸Œì˜ ë™ëŒ€ë¬¸ì—­ì‚¬ë¬¸í™”ê³µì›ì—­ì ', lat: 37.5646, lng: 127.0059 },
      { name: 'ì˜¬ë¦¬ë¸Œì˜ ë˜ë˜ë™ëŒ€ë¬¸ì ', lat: 37.5663, lng: 127.0079 },
      { name: 'ì˜¬ë¦¬ë¸Œì˜ ë‘íƒ€ì ', lat: 37.5667, lng: 127.0072 },
      { name: 'ì˜¬ë¦¬ë¸Œì˜ í˜„ëŒ€ì‹œí‹°ì•„ìš¸ë ›ë™ëŒ€ë¬¸ì ', lat: 37.5659, lng: 127.0074 }
    ];

    const i18n = {
      ko: {
        refresh: 'í˜„ì¬ ìœ„ì¹˜ ê°±ì‹ ',
        btn0: 'ì˜¬ë¦¬ë¸Œì˜ ë™ëŒ€ë¬¸ì—­ì‚¬ë¬¸í™”ê³µì›ì—­ì ',
        btn1: 'ì˜¬ë¦¬ë¸Œì˜ ë˜ë˜ë™ëŒ€ë¬¸ì ',
        btn2: 'ì˜¬ë¦¬ë¸Œì˜ ë‘íƒ€ì ',
        btn3: 'ì˜¬ë¦¬ë¸Œì˜ í˜„ëŒ€ì‹œí‹°ì•„ìš¸ë ›ë™ëŒ€ë¬¸ì ',
        time: t => `ë„ë³´ ì‹œê°„: ì•½ ${t}ë¶„`,
        walkingNotFound: 'ë„ë³´ ê²½ë¡œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.'
      },
      en: {
        refresh: 'Refresh location',
        btn0: 'Olive Young DDP History Park',
        btn1: 'Olive Young Dundun Dongdaemun',
        btn2: 'Olive Young Doota',
        btn3: 'Olive Young Hyundai City Outlet',
        time: t => `Estimated walk time: ~${t} min`,
        walkingNotFound: 'Walking route not found.'
      },
      zh: {
        refresh: 'åˆ·æ–°å½“å‰ä½ç½®',
        btn0: 'Olive Young ä¸œå¤§é—¨å†å²æ–‡åŒ–å…¬å›­åº—',
        btn1: 'Olive Young æ•¦æ•¦ä¸œå¤§é—¨åº—',
        btn2: 'Olive Young Dootaåº—',
        btn3: 'Olive Young ç°ä»£åŸå¸‚å¥¥ç‰¹è±æ–¯åº—',
        time: t => `æ­¥è¡Œæ—¶é—´ï¼šçº¦${t}åˆ†é’Ÿ`,
        walkingNotFound: 'æ— æ³•æ‰¾åˆ°æ­¥è¡Œè·¯çº¿ã€‚'
      },
      ja: {
        refresh: 'ç¾åœ¨åœ°ã‚’æ›´æ–°',
        btn0: 'ã‚ªãƒªãƒ¼ãƒ–ãƒ¤ãƒ³ã‚° æ±å¤§é–€æ­´å²æ–‡åŒ–å…¬åœ’åº—',
        btn1: 'ã‚ªãƒªãƒ¼ãƒ–ãƒ¤ãƒ³ã‚° ãƒ€ãƒ³ãƒ€ãƒ³ãƒ‰ãƒ³ãƒ‡ãƒ ãƒ³åº—',
        btn2: 'ã‚ªãƒªãƒ¼ãƒ–ãƒ¤ãƒ³ã‚° ãƒ‰ã‚¥ãƒ¼ã‚¿åº—',
        btn3: 'ã‚ªãƒªãƒ¼ãƒ–ãƒ¤ãƒ³ã‚° ç¾ä»£ã‚·ãƒ†ã‚£ã‚¢ã‚¦ãƒˆãƒ¬ãƒƒãƒˆåº—',
        time: t => `å¾’æ­©æ™‚é–“ï¼šç´„${t}åˆ†`,
        walkingNotFound: 'å¾’æ­©ãƒ«ãƒ¼ãƒˆãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã€‚'
      }
    };

    let map, userLatLng, userMarker, destMarker, polyline;
    const infoDiv = document.getElementById('info');

    function initMap() {
      if (!navigator.geolocation) {
        alert("ì´ ë¸Œë¼ìš°ì €ëŠ” ìœ„ì¹˜ ì •ë³´ë¥¼ ì§€ì›í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.");
        return;
      }
      navigator.geolocation.getCurrentPosition(pos => {
        userLatLng = new kakao.maps.LatLng(pos.coords.latitude, pos.coords.longitude);
        map = new kakao.maps.Map(document.getElementById('map'), {
          center: userLatLng,
          level: 5
        });
        userMarker = new kakao.maps.Marker({
          map,
          position: userLatLng,
          title: "í˜„ì¬ ìœ„ì¹˜"
        });
      }, () => {
        alert("ìœ„ì¹˜ ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");
      });
    }

    function refreshLocation() {
      navigator.geolocation.getCurrentPosition(pos => {
        userLatLng = new kakao.maps.LatLng(pos.coords.latitude, pos.coords.longitude);
        map.setCenter(userLatLng);
        if (userMarker) userMarker.setPosition(userLatLng);
        infoDiv.innerHTML = i18n[document.getElementById("language").value].refresh + " ì™„ë£Œ!";
      });
    }

    function drawWalkingRoute(origin, destination) {
      const REST_API_KEY = 'ceb3c41a3c5a54270ff432ca02eb6466'; // ì—¬ê¸°ì— í‚¤ ë„£ìŒ
      const url = `https://apis-navi.kakaomobility.com/v1/directions?origin=${origin.lng},${origin.lat}&destination=${destination.lng},${destination.lat}&priority=RECOMMEND&road_details=true&vehicle_type=FOOT`;

      fetch(url, {
        headers: { Authorization: 'KakaoAK ' + REST_API_KEY }
      })
      .then(res => res.json())
      .then(data => {
        if (data.routes && data.routes.length > 0) {
          const route = data.routes[0];
          const coords = [];
          route.sections.forEach(section => {
            section.subPath.forEach(point => {
              coords.push(new kakao.maps.LatLng(point.y, point.x));
            });
          });

          if (polyline) polyline.setMap(null);
          polyline = new kakao.maps.Polyline({
            map: map,
            path: coords,
            strokeWeight: 5,
            strokeColor: '#FF5722',
            strokeOpacity: 0.8,
            strokeStyle: 'solid'
          });

          const bounds = new kakao.maps.LatLngBounds();
          coords.forEach(coord => bounds.extend(coord));
          map.setBounds(bounds);

          const totalTime = Math.round(route.summary.duration / 60);
          const lang = i18n[document.getElementById("language").value];
          infoDiv.innerHTML = `<strong>${destination.name}</strong><br>${lang.time(totalTime)}`;

        } else {
          infoDiv.innerHTML = i18n[document.getElementById("language").value].walkingNotFound;
        }
      })
      .catch(err => {
        console.error('ê¸¸ì°¾ê¸° API ì—ëŸ¬:', err);
        infoDiv.innerHTML = 'ê¸¸ì°¾ê¸° ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¤ì§€ ëª»í–ˆìŠµë‹ˆë‹¤.';
      });
    }

    function setDestination(index) {
      const dest = destinations[index];
      const destLatLng = new kakao.maps.LatLng(dest.lat, dest.lng);

      if (!userLatLng) {
        alert("í˜„ì¬ ìœ„ì¹˜ë¥¼ ë¨¼ì € ë¶ˆëŸ¬ì™€ ì£¼ì„¸ìš”.");
        return;
      }

      if (destMarker) destMarker.setMap(null);
      if (polyline) polyline.setMap(null);

      destMarker = new kakao.maps.Marker({
        map,
        position: destLatLng,
        title: dest.name
      });

      drawWalkingRoute(userLatLng, destLatLng);
    }

    function changeLanguage() {
      const lang = i18n[document.getElementById("language").value];
      document.getElementById("btn0").innerText = lang.btn0;
      document.getElementById("btn1").innerText = lang.btn1;
      document.getElementById("btn2").innerText = lang.btn2;
      document.getElementById("btn3").innerText = lang.btn3;
      document.getElementById("refresh").innerText = lang.refresh;
      infoDiv.innerHTML = "";
    }

    document.addEventListener("DOMContentLoaded", initMap);
  </script>
</body>
</html>
